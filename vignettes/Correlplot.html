<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Jan Graffelman - Universitat Politecnica de Catalunya" />
<meta name="author" content="Jan de Leeuw - University of California Los Angeles" />

<meta name="date" content="2023-03-06" />

<title>Visualization of a correlation matrix with the Correlplot package</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">

div.csl-bib-body { }
div.csl-entry {
clear: both;
}
.hanging div.csl-entry {
margin-left:2em;
text-indent:-2em;
}
div.csl-left-margin {
min-width:2em;
float:left;
}
div.csl-right-inline {
margin-left:2em;
padding-left:1em;
}
div.csl-indent {
margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Visualization of a correlation matrix with
the Correlplot package</h1>
<h4 class="author">Jan Graffelman - Universitat Politecnica de
Catalunya</h4>
<h4 class="author">Jan de Leeuw - University of California Los
Angeles</h4>
<h4 class="date">2023-03-06</h4>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>This documents gives some instructions on how to create graphical
representations of a correlation matrix in the statistical environment R
with package <code>Correlplot</code>, using a variety of different
statistical methods (<span class="citation">Graffelman and De Leeuw
(2023)</span>). We use principal component analysis (PCA),
multidimensional scaling (MDS), principal factor analysis (PFA),
weighted alternating least squares (WALS), correlograms (CRG) and
corrgrams to produce displays of correlation structure. The next section
shows how to use the functions of the package in order to create the
different graphical representations. The computation of goodness-of-fit
statistics is also addressed. All methods are illustrated on a single
data set, the wheat kernel data introduced below.</p>
</div>
<div id="graphical-representations-of-a-correlation-matrix" class="section level2">
<h2>Graphical representations of a correlation matrix</h2>
<p>We first load some packages we will use:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(calibrate)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="co">#&gt; Loading required package: MASS</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="co">#&gt; corrplot 0.92 loaded</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="fu">library</span>(Correlplot)</span></code></pre></div>
<p>Throughout this vignette, we will use the wheat kernel data set taken
from the UCI Machine Learning Repository (<a href="https://archive.ics.uci.edu/ml/datasets/seeds" class="uri">https://archive.ics.uci.edu/ml/datasets/seeds</a>) in order
to illustrate the different plots. The wheat kernel data (<span class="citation">Charytanowicz et al. (2010)</span>) consists of 210
wheat kernels, of which the variables <em>area</em> (<span class="math inline">\(A\)</span>), <em>perimeter</em> (<span class="math inline">\(P\)</span>), <em>compactness</em> (<span class="math inline">\(C = 4*\pi*A/P^2\)</span>), <em>length</em>,
<em>width</em>, <em>asymmetry coefficient</em> and <em>groove</em>
(length of kernel groove) were registered. There are 70 kernels of each
of three varieties <em>Kama</em>, <em>Rosa</em> and <em>Canadian</em>;
here we will only use the kernels of variety <em>Kama</em>. The data is
made available with:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;Kernels&quot;</span>)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>X <span class="ot">&lt;-</span> Kernels[Kernels<span class="sc">$</span>variety<span class="sc">==</span><span class="dv">1</span>,]</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>X <span class="ot">&lt;-</span> X[,<span class="sc">-</span><span class="dv">8</span>]</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="fu">head</span>(X)</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="co">#&gt;    area perimeter compactness length width asymmetry groove</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="co">#&gt; 1 15.26     14.84      0.8710  5.763 3.312     2.221  5.220</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="co">#&gt; 2 14.88     14.57      0.8811  5.554 3.333     1.018  4.956</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="co">#&gt; 3 14.29     14.09      0.9050  5.291 3.337     2.699  4.825</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="co">#&gt; 4 13.84     13.94      0.8955  5.324 3.379     2.259  4.805</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a><span class="co">#&gt; 5 16.14     14.99      0.9034  5.658 3.562     1.355  5.175</span></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a><span class="co">#&gt; 6 14.38     14.21      0.8951  5.386 3.312     2.462  4.956</span></span></code></pre></div>
<p>The correlation matrix of the variables is given by:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="fu">cor</span>(X)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="fu">round</span>(R,<span class="at">digits=</span><span class="dv">3</span>)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co">#&gt;               area perimeter compactness length  width asymmetry groove</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co">#&gt; area         1.000     0.976       0.371  0.835  0.900    -0.050  0.721</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co">#&gt; perimeter    0.976     1.000       0.165  0.921  0.802    -0.054  0.794</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="co">#&gt; compactness  0.371     0.165       1.000 -0.146  0.667     0.037 -0.131</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="co">#&gt; length       0.835     0.921      -0.146  1.000  0.551    -0.037  0.866</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="co">#&gt; width        0.900     0.802       0.667  0.551  1.000    -0.027  0.447</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="co">#&gt; asymmetry   -0.050    -0.054       0.037 -0.037 -0.027     1.000 -0.011</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="co">#&gt; groove       0.721     0.794      -0.131  0.866  0.447    -0.011  1.000</span></span></code></pre></div>
<div id="the-corrgram" class="section level3">
<h3>1. The corrgram</h3>
<p>The corrgram (<span class="citation">Friendly (2002)</span>) is a
tabular display of the entries of a correlation matrix that uses colour
and shading to represent correlations. Corrgrams can be made with the
fuction <code>corrplot</code></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">corrplot</span>(R, <span class="at">method=</span><span class="st">&quot;circle&quot;</span>,<span class="at">type=</span><span class="st">&quot;lower&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="A corrgram of the wheat kernel data." />
<p class="caption">
A corrgram of the wheat kernel data.
</p>
</div>
<p>This shows most correlations are positive, and correlations with
<em>asymmetry</em> are weak.</p>
</div>
<div id="the-correlogram" class="section level3">
<h3>2. The correlogram</h3>
<p>The correlogram (<span class="citation">Trosset (2005)</span>)
represents correlations by the cosines between vectors.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>theta.cos <span class="ot">&lt;-</span> <span class="fu">correlogram</span>(R,<span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.1</span>,<span class="fl">1.1</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.1</span>,<span class="fl">1.1</span>),<span class="at">main=</span><span class="st">&quot;CRG&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="The correlogram of the wheat kernel data." />
<p class="caption">
The correlogram of the wheat kernel data.
</p>
</div>
<p>The vector <code>theta.cos</code> contains the angles (in radians) of
each variable with respect to the positive <span class="math inline">\(x\)</span>-axis. The approximation provided by
these angles to the correlation matrix is calculated by</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>Rhat.cor <span class="ot">&lt;-</span> <span class="fu">angleToR</span>(theta.cos)</span></code></pre></div>
<p>The correlogram always perfectly represents the correlations of the
variables with themselves, and these have a structural contribution of
zero to the loss function. We calculate the root mean squared error
(RMSE) of the approximation by using function <code>rmse</code>. We
include the diagonal in the RMSE calculation by setting
<code>omit.diagonal</code> to <code>FALSE</code>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>rmse.crg <span class="ot">&lt;-</span> <span class="fu">rmse</span>(R,Rhat.cor,<span class="at">omit.diagonal=</span><span class="cn">FALSE</span>)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>rmse.crg</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="co">#&gt; [1] 0.2437535</span></span></code></pre></div>
<p>This gives and RMSE of 0.2438, which shows this representation has a
large amount of error. The correlogram can be modified by using a linear
interpretation rule, rendering correlations linear in the angle (<span class="citation">Graffelman (2013)</span>). This representation is
obtained by:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>theta.lin <span class="ot">&lt;-</span> <span class="fu">correlogram</span>(R,<span class="at">ifun=</span><span class="st">&quot;lincos&quot;</span>,<span class="at">labs=</span><span class="fu">colnames</span>(R),<span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.1</span>,<span class="fl">1.1</span>),</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>                         <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.1</span>,<span class="fl">1.1</span>),<span class="at">main=</span><span class="st">&quot;CRG&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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QhLYsUkg4jgJRxeDXWPK9pTog+sJ5B4BRxORen4hqGsJ0FgLSL4AMXiVolq9iAxKkILWLrA4N5JHFUKA3vJAUXRkUoYYjL5hpPBCPpVIMX/vmwfwSk61iLEsOit7ypUKZLYQyGvh48iuIClF9GZmaE+5YoFqIrY0T3vKlQtUxmpsrvaUFKgM7VARf10ZlZxrkxOqx3m748i+QCn+FxQrsKekQD28rW5yX291WEmZC1D2fkXuONZUq5yiWO7BLf8nA1ZX8BKKFs2f5M1a615IMYZ1MHM4AkQFBSIqKBBRQYGICgpEVFAgooICERUUiKigQEQFBSIqKBBRQYGICgpEVFAgooICERUUiKigQEQFBSIqKBBRQYGICgpEVFAgooICERUUiKigQEQFBSIqKBBRQYGICgpEVFAgooICERUUiKigQEQFBSIqKBBRQYGICgpEVFAgooICERUUiKigQEQFBSIqKBBRQYGICgpEVFAgooICERUUiKigQEQFBSIqKBBRQYGICgpEVFAgooICERUUiKigQEQFBSIqKBBRQYGICgpEVFAgooICERUUiKigQEQFBSIqKBBRQYGICgpEVFAgooICERUUiKigQEQFBSIqKBBRQYGICgpEVFAgooICERUUiKigQEQFBSIqKBBRQYGICgpEVFAgooICERUUiKigQEQFBSIqKBBRQYGICgpEVFAgooICERUUiKigQEQFBSIqKBBRQYGICgpEVFAgooICERUUiKigQEQFBSIqKBBRQYGICgpEVFAgooICERUUiKigQEQFBSIqKBBRQYGICgpEVFAgooICERUUiKigQEQFBSIqKBBRQYGICgpEVFAgooICERUUiKigQETF/wMFleOVFLMPCwAAAABJRU5ErkJggg==" alt="Linear correlogram of the wheat kernel data." />
<p class="caption">
Linear correlogram of the wheat kernel data.
</p>
</div>
<p>The approximation to the correlation matrix by using this linear
interpretation function is calculated by</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>Rhat.corlin <span class="ot">&lt;-</span> <span class="fu">angleToR</span>(theta.lin,<span class="at">ifun=</span><span class="st">&quot;lincos&quot;</span>)</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>rmse.lin <span class="ot">&lt;-</span> <span class="fu">rmse</span>(R,Rhat.corlin,<span class="at">omit.diagonal=</span><span class="cn">FALSE</span>)</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>rmse.lin</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="co">#&gt; [1] 0.173949</span></span></code></pre></div>
<p>and this gives a RMSE of 0.1739. In this case, the linear
representation is seen to improve the approximation.</p>
</div>
<div id="the-pca-biplot-of-the-correlation-matrix" class="section level3">
<h3>3. The PCA biplot of the correlation matrix</h3>
<p>We create a PCA biplot of the correlation matrix, doing the
calculations for a PCA by hand, using the singular value decomposition
of the (scaled) standardized data. Alternatively, standard R function
<code>princomp</code> may be used to obtain the coordinates needed for
the correlation biplot. We use function <code>bplot</code> from package
<code>calibrate</code> to make the biplot:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(X)</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>Xt <span class="ot">&lt;-</span> <span class="fu">scale</span>(X)<span class="sc">/</span><span class="fu">sqrt</span>(n<span class="dv">-1</span>)</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>res.svd <span class="ot">&lt;-</span> <span class="fu">svd</span>(Xt)</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>Fs <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(n)<span class="sc">*</span>res.svd<span class="sc">$</span>u <span class="co"># standardized principal components</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>Gp <span class="ot">&lt;-</span> res.svd<span class="sc">$</span>v<span class="sc">%*%</span><span class="fu">diag</span>(res.svd<span class="sc">$</span>d) <span class="co"># biplot coordinates for variables</span></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a><span class="fu">bplot</span>(Fs,Gp,<span class="at">colch=</span><span class="cn">NA</span>,<span class="at">collab=</span><span class="fu">colnames</span>(X),<span class="at">xlab=</span><span class="st">&quot;PC1&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;PC2&quot;</span>,<span class="at">main=</span><span class="st">&quot;PCA&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="PCA biplot of the wheat kernel data." />
<p class="caption">
PCA biplot of the wheat kernel data.
</p>
</div>
<p>The joint representation of kernels and variables emphasizes this is
a biplot of the (standardized) data matrix. However, this plot is a
<em>double biplot</em> because scalar products between variable vectors
approximate the correlation matrix. We stress this by plotting the
variable vectors only, and adding a unit circle:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">bplot</span>(Gp,Gp,<span class="at">colch=</span><span class="cn">NA</span>,<span class="at">rowch=</span><span class="cn">NA</span>,<span class="at">collab=</span><span class="fu">colnames</span>(X),<span class="at">xl=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>      <span class="at">yl=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>),<span class="at">main=</span><span class="st">&quot;PCA&quot;</span>)</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="fu">circle</span>()</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="PCA biplot of the correlation matrix." />
<p class="caption">
PCA biplot of the correlation matrix.
</p>
</div>
<p>The PCA biplot of the correlation matrix can be obtained from a
correlation-based PCA or also directly from the spectral decomposition
of the correlation matrix. The rank two approximation, obtained by means
of scalar products between vectors, is calculated by:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>Rhat.pca <span class="ot">&lt;-</span> Gp[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]<span class="sc">%*%</span><span class="fu">t</span>(Gp[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])</span></code></pre></div>
<p>In principle, PCA also tries to approximate the ones on the diagonal
of the correlation matrix. These are included in the RMSE calculation by
setting <code>omit.diagonal</code> to <code>FALSE</code>.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>rmse.pca <span class="ot">&lt;-</span> <span class="fu">rmse</span>(R,Rhat.pca,<span class="at">omit.diagonal=</span><span class="cn">FALSE</span>)</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>rmse.pca</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a><span class="co">#&gt; [1] 0.145959</span></span></code></pre></div>
<p>This gives a RMSE of 0.1460, which is an improvement over the
previous correlograms. Function <code>rmse</code> can also be used to
calculate the RMSE of each variable separately:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">rmse</span>(R,Rhat.pca,<span class="at">omit.diagonal=</span><span class="cn">FALSE</span>,<span class="at">per.variable=</span><span class="cn">TRUE</span>)</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="co">#&gt;       area       peri       comp       leng       widt       asym       groo </span></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="co">#&gt; 0.01403868 0.02158021 0.03255115 0.02480187 0.02151041 0.37610214 0.06982317</span></span></code></pre></div>
<p>This shows that <em>asymmetry</em> has the worst fit.</p>
</div>
<div id="the-mds-map-of-a-correlation-matrix" class="section level3">
<h3>4. The MDS map of a correlation matrix</h3>
<p>We transform correlations to distances with the <span class="math inline">\(\sqrt{2(1-r)}\)</span> transformation, and use the
<code>cmdscale</code> function from the <code>stats</code> package to
perform metric multidimensional scaling. We mark negative correlations
with a dashed red line.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>Di <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>R))</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>out.mds <span class="ot">&lt;-</span> <span class="fu">cmdscale</span>(Di,<span class="at">eig =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>Fp <span class="ot">&lt;-</span> out.mds<span class="sc">$</span>points</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>opar <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">bty =</span> <span class="st">&quot;l&quot;</span>)</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a><span class="fu">plot</span>(Fp[,<span class="dv">1</span>],Fp[,<span class="dv">2</span>],<span class="at">asp=</span><span class="dv">1</span>,<span class="at">xlab=</span><span class="st">&quot;First principal axis&quot;</span>,</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">&quot;Second principal axis&quot;</span>,<span class="at">main=</span><span class="st">&quot;MDS&quot;</span>)</span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a><span class="fu">textxy</span>(Fp[,<span class="dv">1</span>],Fp[,<span class="dv">2</span>],<span class="fu">colnames</span>(R),<span class="at">cex=</span><span class="fl">0.75</span>)</span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a><span class="fu">par</span>(opar)</span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a></span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a>ii <span class="ot">&lt;-</span> <span class="fu">which</span>(R <span class="sc">&lt;</span> <span class="dv">0</span>,<span class="at">arr.ind =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(ii)) {</span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a>  <span class="fu">segments</span>(Fp[ii[i,<span class="dv">1</span>],<span class="dv">1</span>],Fp[ii[i,<span class="dv">1</span>],<span class="dv">2</span>],</span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a>           Fp[ii[i,<span class="dv">2</span>],<span class="dv">1</span>],Fp[ii[i,<span class="dv">2</span>],<span class="dv">2</span>],<span class="at">col=</span><span class="st">&quot;red&quot;</span>,<span class="at">lty=</span><span class="st">&quot;dashed&quot;</span>)</span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a>}</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="MDS map of the correlation matrix of the wheat kernel data." />
<p class="caption">
MDS map of the correlation matrix of the wheat kernel data.
</p>
</div>
<p>We calculate distances in the map, convert these back to
correlations:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>Dest <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">dist</span>(Fp[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]))</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>Rhat.mds <span class="ot">&lt;-</span> <span class="dv">1</span><span class="fl">-0.5</span><span class="sc">*</span>Dest<span class="sc">*</span>Dest</span></code></pre></div>
<p>Again, correlations of the variables with themselves are perfectly
approximated (zero distance), and we include these in the RMSE
calculations:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>rmse.mds <span class="ot">&lt;-</span> <span class="fu">rmse</span>(R,Rhat.mds,<span class="at">omit.diagonal=</span><span class="cn">FALSE</span>)</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>rmse.mds</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a><span class="co">#&gt; [1] 0.06837469</span></span></code></pre></div>
</div>
<div id="the-pfa-biplot-of-a-correlation-matrix" class="section level3">
<h3>5. The PFA biplot of a correlation matrix</h3>
<p>Principal factor analysis can be performed by the function
<code>pfa</code> of package <code>Correlplot</code>. We extract the
factor loadings.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>out.pfa <span class="ot">&lt;-</span> Correlplot<span class="sc">::</span><span class="fu">pfa</span>(X,<span class="at">verbose=</span><span class="cn">FALSE</span>)</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>L <span class="ot">&lt;-</span> out.pfa<span class="sc">$</span>La</span></code></pre></div>
<p>The biplot of the correlation matrix obtained by PFA is in fact the
same as what is known as a factor loading plot in factor analysis, to
which a unit circle can be added. The approximation to the correlation
matrix and its RMSE are calculated as:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>Rhat.pfa <span class="ot">&lt;-</span> L[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]<span class="sc">%*%</span><span class="fu">t</span>(L[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>rmse.pfa <span class="ot">&lt;-</span> <span class="fu">rmse</span>(R,Rhat.pfa)</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>rmse.pfa</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a><span class="co">#&gt; [1] 0.01119688</span></span></code></pre></div>
<p>In this case, the diagonal is excluded, for PFA explicitly avoids
fitting the diagonal. To make the factor loading plot, aka PFA biplot of
the correlation matrix:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="fu">bplot</span>(L,L,<span class="at">pch=</span><span class="cn">NA</span>,<span class="at">xl=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>),<span class="at">yl=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;Factor 1&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Factor 2&quot;</span>,<span class="at">main=</span><span class="st">&quot;PFA&quot;</span>,<span class="at">rowch=</span><span class="cn">NA</span>,</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>     <span class="at">colch=</span><span class="cn">NA</span>)</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a><span class="fu">circle</span>()</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="PFA biplot of the correlation matrix of the wheat kernel data." />
<p class="caption">
PFA biplot of the correlation matrix of the wheat kernel data.
</p>
</div>
<p>The RMSE of the plot obtained by PFA is 0.0112, lower than the RMSE
obtained by PCA. Note that variable <em>area</em> reaches the unit
circle for having a communality of 1, or, equivalently, specificity 0,
i.e.PFA produces what is known as a <em>Heywood case</em> in factor
analysis. The specificities are given by:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="fu">diag</span>(out.pfa<span class="sc">$</span>Psi)</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a><span class="co">#&gt;        area        peri        comp        leng        widt        asym </span></span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a><span class="co">#&gt; 0.000000000 0.011494664 0.158097108 0.007885055 0.022509545 0.997799829 </span></span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a><span class="co">#&gt;        groo </span></span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a><span class="co">#&gt; 0.258768379</span></span></code></pre></div>
</div>
<div id="the-wals-biplot-of-a-correlation-matrix" class="section level3">
<h3>6. The WALS biplot of a correlation matrix</h3>
<p>The correlation matrix can also be factored using weighted
alternating least squares, avoiding the fit of the ones on the diagonal
of the correlation matrix by assigning them weight 0, using function
<code>ipSymLS</code> (<span class="citation">De Leeuw
(2006)</span>).</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>W <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span>,<span class="fu">nrow</span>(R),<span class="fu">nrow</span>(R))</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a><span class="fu">diag</span>(W) <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>Fp.als <span class="ot">&lt;-</span> <span class="fu">ipSymLS</span>(R,<span class="at">w=</span>W,<span class="at">eps=</span><span class="fl">1e-15</span>)</span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="fu">bplot</span>(Fp.als,Fp.als,<span class="at">rowch=</span><span class="cn">NA</span>,<span class="at">colch=</span><span class="cn">NA</span>,<span class="at">collab=</span><span class="fu">colnames</span>(R),</span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>      <span class="at">xl=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.1</span>,<span class="fl">1.1</span>),<span class="at">yl=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.1</span>,<span class="fl">1.1</span>),<span class="at">main=</span><span class="st">&quot;WALS&quot;</span>)</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a><span class="fu">circle</span>()</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="WALS biplot of the correlation matrix of the wheat kernel data." />
<p class="caption">
WALS biplot of the correlation matrix of the wheat kernel data.
</p>
</div>
<p>Weighted alternating least squares has, in contrast to PFA, no
restriction on the vector length. If the vector lengths in the biplot
are calculated, then variable <em>area</em> is seen to just move out of
the unit circle.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a>Rhat.wals <span class="ot">&lt;-</span> Fp.als<span class="sc">%*%</span><span class="fu">t</span>(Fp.als)</span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">diag</span>(Rhat.wals))</span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a><span class="co">#&gt; [1] 1.00124368 0.99394213 0.91345321 0.99646265 0.99026217 0.04686397 0.86124152</span></span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a>rmse.als <span class="ot">&lt;-</span> <span class="fu">rmse</span>(R,Rhat.wals)</span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a>rmse.als</span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a><span class="co">#&gt; [1] 0.01118619</span></span></code></pre></div>
<p>The RMSE of the approximation obtained by WALS is 0.011186, slightly
below the RMSE of PFA. The WALS low rank approximation to the
correlation matrix can also be obtained by the more generic function
<code>wAddPCA</code>, which allows for non-symmetric matrices and
adjustments (see the next section). In order to get uniquely defined
biplot vectors for each variable, corresponding to symmetric input, an
eigendecomposition is applied to the fitted correlation matrix.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">nrow</span>(R)</span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a>W <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span>,p,p)</span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a><span class="fu">diag</span>(W) <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a>out.wals <span class="ot">&lt;-</span> <span class="fu">wAddPCA</span>(R, W, <span class="at">add =</span> <span class="st">&quot;nul&quot;</span>, <span class="at">verboseout =</span> <span class="cn">FALSE</span>, <span class="at">epsout =</span> <span class="fl">1e-10</span>)</span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a>Rhat.wals <span class="ot">&lt;-</span> out.wals<span class="sc">$</span>a<span class="sc">%*%</span><span class="fu">t</span>(out.wals<span class="sc">$</span>b)</span>
<span id="cb25-6"><a href="#cb25-6" tabindex="-1"></a>out.eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(Rhat.wals)</span>
<span id="cb25-7"><a href="#cb25-7" tabindex="-1"></a>Fp.adj <span class="ot">&lt;-</span> out.eig<span class="sc">$</span>vectors[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]<span class="sc">%*%</span><span class="fu">diag</span>(<span class="fu">sqrt</span>(out.eig<span class="sc">$</span>values[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]))</span>
<span id="cb25-8"><a href="#cb25-8" tabindex="-1"></a>rmse.als <span class="ot">&lt;-</span> <span class="fu">rmse</span>(R,Rhat.wals)</span>
<span id="cb25-9"><a href="#cb25-9" tabindex="-1"></a>rmse.als</span>
<span id="cb25-10"><a href="#cb25-10" tabindex="-1"></a><span class="co">#&gt; [1] 0.01118619</span></span></code></pre></div>
</div>
<div id="the-wals-biplot-using-an-adjustment-of-the-correlation-matrix" class="section level3">
<h3>7. The WALS biplot using an adjustment of the correlation
matrix</h3>
<p>A scalar adjustment can be employed to improve the approximation of
the correlation matrix, and the adjusted correlation matrix is factored
for a biplot representation. That means we seek the factorization</p>
<p><span class="math display">\[
{\mathbf R}_a = {\mathbf R} - \delta {\mathbf J} = {\mathbf G} {\mathbf
G}&#39;,
\]</span></p>
<p>where both <span class="math inline">\(\delta\)</span> and <span class="math inline">\(\mathbf G\)</span> are chosen such that the
(weighted) residual sum of squares is minimal. This problem is solved by
using function <code>wAddPCA</code>.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">nrow</span>(R)</span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a>W <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span>,p,p)</span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a><span class="fu">diag</span>(W) <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a>out.wals <span class="ot">&lt;-</span> <span class="fu">wAddPCA</span>(R, W, <span class="at">add =</span> <span class="st">&quot;one&quot;</span>, <span class="at">verboseout =</span> <span class="cn">FALSE</span>, <span class="at">epsout =</span> <span class="fl">1e-10</span>)</span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a>delta <span class="ot">&lt;-</span> out.wals<span class="sc">$</span>delta[<span class="dv">1</span>,<span class="dv">1</span>]</span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a>Rhat <span class="ot">&lt;-</span> out.wals<span class="sc">$</span>a<span class="sc">%*%</span><span class="fu">t</span>(out.wals<span class="sc">$</span>b)</span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a>out.eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(Rhat)</span>
<span id="cb26-8"><a href="#cb26-8" tabindex="-1"></a>Fp.adj <span class="ot">&lt;-</span> out.eig<span class="sc">$</span>vectors[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]<span class="sc">%*%</span><span class="fu">diag</span>(<span class="fu">sqrt</span>(out.eig<span class="sc">$</span>values[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]))</span></code></pre></div>
<p>The optimal adjustment <span class="math inline">\(\delta\)</span> is
0.071. The corresponding biplot is shown below.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="fu">bplot</span>(Fp.adj,Fp.adj,<span class="at">rowch=</span><span class="cn">NA</span>,<span class="at">colch=</span><span class="cn">NA</span>,<span class="at">collab=</span><span class="fu">colnames</span>(R),</span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a>      <span class="at">xl=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.2</span>,<span class="fl">1.2</span>),<span class="at">yl=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.2</span>,<span class="fl">1.2</span>),<span class="at">main=</span><span class="st">&quot;WALS adjusted&quot;</span>)</span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a><span class="fu">circle</span>()</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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ZbiDzixQhjvozAJluIPOLFCGO+jMAmW4g84sUIY76MwCZbiDzixQhjvozAJluIPOLFCGO+jMAmW4g84sUIY76MwCZbiDzixQhjvozAJluIPOLFCGO+jMAmW4g84sUIY76MwCZbiDzixQhjvozAJluIPOLFCGO+jMAmW4g84sUIY76MwCZbiDzixQhjvozAJluIPOLFCGO+jMAmW4g84sUIY76MwCZbiDzixQhjvozAJluIPOLFCGO+jMAmW4g84sUIY76MwCZbiDzixQhjvozAJluIPOLFCGO+jMAmW4g84sUAZgAYEACwgEWEAgwAICARYQCLCAQIAFBAIsIBBgAYEACwgEWEAgwAICARYQCLCAQIAFBAIsIBBgAYEACwgEWEAgwAICARYQCLCAQIAFBAIsIBBgAYEACwgEWEAgwAICARYQCLCAQIAFBAIsIBBgAYEACwgEWEAgwAICARYQCLCAQIAFBAIsIBBgAYEACwgEWEAgwAICARYQCLCAQIAFBAIsIBBgAYEACwgEWEAgwAICARYQCLCAQIAFBAIsIBBgAYEACwgEWEAgwAICARYQCLCAQIAFBAIsIBBgAYEACwgEWEAgwAICARYQCLCAQIAFBAIsIBBgAYEACwgEWEAgwAICARYQCLCAQIAFBAIsIBBgAYEACwgEWEAgwAICARYQCLCAQIAFBAIsIBBgAYEACwgEWEAgwAICARYQCLCAQIAFBAIsIBBg8f9vQR+WELbHgQAAAABJRU5ErkJggg==" alt="WALS biplot of the correlation matrix of the wheat kernel data, with the use of an additive adjustment." />
<p class="caption">
WALS biplot of the correlation matrix of the wheat kernel data, with the
use of an additive adjustment.
</p>
</div>
<p>Note that, when calculating the fitted correlation matrix, adjustment
<span class="math inline">\(\delta\)</span> is added back. The fitted
correlation matrix and its RMSE are now calculated as:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a>Rhat.adj <span class="ot">&lt;-</span> Fp.adj<span class="sc">%*%</span><span class="fu">t</span>(Fp.adj)<span class="sc">+</span>delta</span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>rmse.adj <span class="ot">&lt;-</span> <span class="fu">rmse</span>(R,Rhat.adj)</span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a>rmse.adj</span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a><span class="co">#&gt; [1] 0.005560242</span></span></code></pre></div>
<p>This gives RMSE 0.0056. This is smaller than the RMSE obtained by
WALS without adjustment. We summarize the values of the RMSE of all
methods in a table below:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a>rmsevector <span class="ot">&lt;-</span> <span class="fu">c</span>(rmse.crg,rmse.lin,rmse.pca,rmse.mds,rmse.pfa,rmse.als,rmse.adj)</span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a>methods <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;CRG (cos)&quot;</span>,<span class="st">&quot;CRG (lin)&quot;</span>,<span class="st">&quot;PCA&quot;</span>,<span class="st">&quot;MDS&quot;</span>,</span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a><span class="st">&quot;PFA&quot;</span>,<span class="st">&quot;WALS R&quot;</span>,<span class="st">&quot;WALS Radj&quot;</span>)</span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(methods,rmsevector)</span>
<span id="cb29-5"><a href="#cb29-5" tabindex="-1"></a>results <span class="ot">&lt;-</span> results[<span class="fu">order</span>(rmsevector),]</span>
<span id="cb29-6"><a href="#cb29-6" tabindex="-1"></a>results</span>
<span id="cb29-7"><a href="#cb29-7" tabindex="-1"></a><span class="co">#&gt;     methods  rmsevector</span></span>
<span id="cb29-8"><a href="#cb29-8" tabindex="-1"></a><span class="co">#&gt; 7 WALS Radj 0.005560242</span></span>
<span id="cb29-9"><a href="#cb29-9" tabindex="-1"></a><span class="co">#&gt; 6    WALS R 0.011186190</span></span>
<span id="cb29-10"><a href="#cb29-10" tabindex="-1"></a><span class="co">#&gt; 5       PFA 0.011196885</span></span>
<span id="cb29-11"><a href="#cb29-11" tabindex="-1"></a><span class="co">#&gt; 4       MDS 0.068374694</span></span>
<span id="cb29-12"><a href="#cb29-12" tabindex="-1"></a><span class="co">#&gt; 3       PCA 0.145959040</span></span>
<span id="cb29-13"><a href="#cb29-13" tabindex="-1"></a><span class="co">#&gt; 2 CRG (lin) 0.173948960</span></span>
<span id="cb29-14"><a href="#cb29-14" tabindex="-1"></a><span class="co">#&gt; 1 CRG (cos) 0.243753461</span></span></code></pre></div>
<p>A summary of RMSE calculations for four methods (PCA and WALS, both
with and without <span class="math inline">\(\delta\)</span> adjustment)
can be obtained by the functions <code>FitRwithPCAandWALS</code> and
<code>rmsePCAandWALS</code>; the first applies the four methods to the
correlation matrix, and the latter calculates the RMSE statistics for
the four approximations. The bottom line of the table produced by
<code>rmsePCAandWALS</code> gives the overall RMSE for each methods.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a>output <span class="ot">&lt;-</span> <span class="fu">FitRwithPCAandWALS</span>(R,<span class="at">eps=</span><span class="fl">1e-15</span>)</span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a><span class="fu">rmsePCAandWALS</span>(R,output)</span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a><span class="co">#&gt;         PCA  PCA-A   WALS WALS-A</span></span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a><span class="co">#&gt; area 0.0140 0.0535 0.0081 0.0043</span></span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a><span class="co">#&gt; peri 0.0216 0.0399 0.0088 0.0064</span></span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a><span class="co">#&gt; comp 0.0326 0.0602 0.0110 0.0054</span></span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a><span class="co">#&gt; leng 0.0248 0.0467 0.0067 0.0045</span></span>
<span id="cb30-8"><a href="#cb30-8" tabindex="-1"></a><span class="co">#&gt; widt 0.0215 0.0639 0.0076 0.0068</span></span>
<span id="cb30-9"><a href="#cb30-9" tabindex="-1"></a><span class="co">#&gt; asym 0.3761 0.1253 0.0181 0.0049</span></span>
<span id="cb30-10"><a href="#cb30-10" tabindex="-1"></a><span class="co">#&gt; groo 0.0698 0.0695 0.0135 0.0061</span></span>
<span id="cb30-11"><a href="#cb30-11" tabindex="-1"></a><span class="co">#&gt; All  0.1460 0.0706 0.0112 0.0056</span></span></code></pre></div>
</div>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="unnumbered">References</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Charytanowicz" class="csl-entry">
Charytanowicz, M., J. Niewczas, P. Kulczycki, P. A. Kowalski, S.
Lukasik, and S. Zak. 2010. <span>A Complete Gradient Clustering
Algorithm for Features Analysis of x-Ray Images.</span> In
<em>Information Technologies in Biomedicine</em>, edited by Ewa Pietka
and Jacek Kawa, 1524. Berlin-Heidelberg: Springer-Verlag.
</div>
<div id="ref-DeLeeuw" class="csl-entry">
De Leeuw, J. 2006. <span>A Decomposition Method for Weighted Least
Squares Low-Rank Approximation of Symmetric Matrices.</span>
<em>Department of Statistics, UCLA</em>. <a href="https://escholarship.org/uc/item/1wh197mh">https://escholarship.org/uc/item/1wh197mh</a>.
</div>
<div id="ref-Friendly" class="csl-entry">
Friendly, M. 2002. <span>Corrgrams: Exploratory Displays for
Correlation Matrices.</span> <em>The American Statistician</em> 56 (4):
31624. <a href="https://doi.org/10.1198/000313002533">https://doi.org/10.1198/000313002533</a>.
</div>
<div id="ref-Graffelman2013" class="csl-entry">
Graffelman, J. 2013. <span>Linear-Angle Correlation Plots: New Graphs
for Revealing Correlation Structure.</span> <em>Journal of
Computational and Graphical Statistics</em> 22 (1): 92106. <a href="https://doi.org/10.1080/15533174.2012.707850">https://doi.org/10.1080/15533174.2012.707850</a>.
</div>
<div id="ref-GraffelmanDeLeeuw" class="csl-entry">
Graffelman, J., and J. De Leeuw. 2023. <span>Improved Approximation and
Visualization of the Correlation Matrix.</span> <em>The American
Statistician</em>, 120. <a href="https://doi.org/10.1080/00031305.2023.2186952">https://doi.org/10.1080/00031305.2023.2186952</a>.
</div>
<div id="ref-Trosset" class="csl-entry">
Trosset, M. W. 2005. <span>Visualizing Correlation.</span> <em>Journal
of Computational and Graphical Statistics</em> 14 (1): 119. <a href="https://doi.org/10.1198/106186005X27004">https://doi.org/10.1198/106186005X27004</a>.
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
